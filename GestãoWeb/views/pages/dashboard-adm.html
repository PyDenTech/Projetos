<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>PyDenExpress</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="/img/favicon.png" rel="icon">
  <link href="/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <style>
    .badge {
      padding: 0.5em 0.75em;
      border-radius: 0.25rem;
      font-size: 0.875em;
    }

    .badge-primary {
      background-color: #007bff;
      color: white;
    }

    .badge-success {
      background-color: #28a745;
      color: white;
    }

    .badge-warning {
      background-color: #ffc107;
      color: black;
    }

    .badge-danger {
      background-color: #dc3545;
      color: white;
    }

    /* Estilização das tabelas */
    .table {
      background-color: #fff;
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      margin-bottom: 1rem;
      color: #212529;
    }

    .table th,
    .table td {
      vertical-align: middle;
      padding: 0.75rem;
      border-top: 1px solid #dee2e6;
    }

    .table thead th {
      vertical-align: bottom;
      border-bottom: 2px solid #dee2e6;
      background-color: #f8f9fa;
    }

    .table tbody tr:hover {
      background-color: #f1f3f5;
    }

    .pagination-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
    }

    .pagination {
      margin-bottom: 0;
    }

    .page-item.active .page-link {
      background-color: #007bff;
      border-color: #007bff;
    }

    .page-link {
      color: #007bff;
    }

    .page-link:hover {
      color: #0056b3;
    }

    .page-link:focus {
      box-shadow: none;
    }

    .badge {
      display: inline-block;
      padding: 0.25em 0.4em;
      font-size: 75%;
      font-weight: 700;
      line-height: 1;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: 0.25rem;
    }

    .badge-primary {
      color: #fff;
      background-color: #007bff;
    }

    .badge-primary[href]:focus,
    .badge-primary[href]:hover {
      background-color: #0069d9;
    }

    .badge-success {
      color: #fff;
      background-color: #28a745;
    }

    .badge-success[href]:focus,
    .badge-success[href]:hover {
      background-color: #218838;
    }

    .badge-info {
      color: #fff;
      background-color: #17a2b8;
    }

    .badge-info[href]:focus,
    .badge-info[href]:hover {
      background-color: #138496;
    }

    .badge-warning {
      color: #212529;
      background-color: #ffc107;
    }

    .badge-warning[href]:focus,
    .badge-warning[href]:hover {
      background-color: #d39e00;
    }

    .badge-danger {
      color: #fff;
      background-color: #dc3545;
    }

    .badge-danger[href]:focus,
    .badge-danger[href]:hover {
      background-color: #bd2130;
    }
  </style>

  <link href="/css/style.css" rel="stylesheet">

</head>

<body>

  <header id="header" class="header fixed-top d-flex align-items-center">

    <i class="bi bi-list toggle-sidebar-btn"></i>
    <div class="d-flex align-items-center justify-content-between">
      <a href="/dashboard-escolar" class="logo d-flex align-items-center">
        <img src="/img/logo.png" alt="">
      </a>
    </div><!-- End Logo -->

    <nav class="header-nav ms-auto">
      <ul class="d-flex align-items-center">

        <li class="nav-item dropdown pe-3">
          <a id="profile-link" class="nav-link nav-profile d-flex align-items-center pe-0" href="#"
            data-bs-toggle="dropdown">
            <img id="profile-image" src="/img/user.png" alt="Foto de Perfil" class="rounded-circle">
            <span id="usuarioNome" class="d-none d-md-block dropdown-toggle ps-2"></span>
          </a><!-- End Profile Image Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
            <li>
              <a class="dropdown-item d-flex align-items-center" href="/users-profile">
                <i class="bi bi-person"></i>
                <span>Meu Perfil</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="/users-profile">
                <i class="bi bi-gear"></i>
                <span>Configurações de Conta</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="/faq">
                <i class="bi bi-question-circle"></i>
                <span>Ajuda</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="#" id="logout-link">
                <i class="bi bi-box-arrow-right"></i>
                <span>Sair</span>
              </a>
            </li>
          </ul><!-- End Profile Dropdown Items -->
        </li><!-- End Profile Nav -->

      </ul>
    </nav><!-- End Icons Navigation -->

  </header><!-- End Header -->

  <!-- ======= Sidebar ======= -->
  <aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">
      <li class="nav-heading">Transporte Escolar</li>
      <li class="nav-item">
        <a class="nav-link collapsed" href="/dashboard-escolar">
          <i class="bi bi-speedometer2"></i>
          <span>Painel de Controle</span>
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#escolas-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/escolas.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          <span>Escolas</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="escolas-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-escolas-form">
              <i class="bi bi-house-door"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-escolas-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#aluno-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/aluno.svg" alt="Censo Escolar"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          <span>Alunos</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="aluno-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-aluno-form">
              <i class="bi bi-person-plus"></i><span>Solicitar Cadastro</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-alunos-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
          <li>
            <a href="/importar-aluno-form">
              <i class="bi bi-file-earmark-arrow-up"></i><span>Importar Dados</span>
            </a>
          </li>

        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#routs-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/rotas.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          </i><span>Rotas</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="routs-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-rotas-form">
              <i class="bi bi-plus-square"></i><span>Cadastrar Rota</span>
            </a>
          </li>
          <li>
            <a href="/desenhar-rotas-map">
              <i class="bi bi-pencil"></i><span>Gerar Rotas</span>
            </a>
          </li>
          <li>
            <a href="/visualizar-rotas">
              <i class="bi bi-eye"></i><span>Vizualizar Rotas</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#driverbus-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/motoristas.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          <span>Motoristas</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="driverbus-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-motorista-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-motoristas-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
          <li>
            <a href="/gerar-relatorio-view">
              <i class="bi bi-clipboard2-check"></i><span>Relatórios</span>
            </a>
          </li>

        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#charts-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/monitor-icone-branco.png" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          </i><span>Monitores</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="charts-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-monitores-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-monitores-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#fornecedores-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/fornecedores.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          </i><span>Fornecedor</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="fornecedores-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-fornecedores-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-fornecedores-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>

        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#bus-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/frotas.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          </i><span>Frota</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="bus-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-onibus-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-onibus-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
          <li>
            <a href="/vizualizar-onibus-map">
              <i class="bi bi-eye"></i><span>Vizualizar</span>
            </a>
          </li>
          <li>
            <a href="/solicitar-onibus-services">
              <i class="bi bi-file-earmark-text"></i><span>Ordem de Serviço</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-heading">Administrativo</li>
      <li class="nav-item">
        <a class="nav-link" href="dashboard-adm.html">
          <i class="bi bi-speedometer"></i>
          <span>Painel de Controle</span>
        </a>
      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#car-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-car-front"></i><span>Frota</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="car-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-carro-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-carros-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
          <li>
            <a href="/localizar-carros-map">
              <i class="bi bi-geo-alt-fill"></i><span>Localizar</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#drivercar-nav" data-bs-toggle="collapse" href="#">
          <img src="/img/icones/motoristas.svg" alt="Escolas"
            style="width: 20px; height: 20px; margin-right: 5px; color: white;">
          <span>Motoristas</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="drivercar-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-motorista-carro-form">
              <i class="bi bi-person-plus"></i><span>Cadastrar</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-motorista-carro-form">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#tarefas-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-list-check"></i><span>Tarefas</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="tarefas-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-demandas">
              <i class="bi bi-file-earmark-text"></i><span>Nova Tarefa</span>
            </a>
          </li>
          <li>
            <a href="/tasks">
              <i class="bi bi-person-plus"></i><span>Gerenciar Tarefas</span>
            </a>
          </li>
        </ul>
      </li>

      <li class="nav-heading">Controle Financeiro</li>
      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#fuel-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-droplet-half"></i><span>Abastecimento</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="fuel-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/cadastrar-abastecimento-view">
              <i class="bi bi-file-earmark-text"></i><span>Cadastrar Requisição</span>
            </a>
          </li>
          <li>
            <a href="/gerenciar-abastecimento-view">
              <i class="bi bi-pencil-square"></i><span>Gerenciar</span>
            </a>
          </li>
        </ul>
      </li>

    </ul>

  </aside><!-- End Sidebar-->

  <main id="main" class="main">

    <div class="pagetitle">
      <h1>Controle Transporte Administrativo <i class="bi bi-car-front"></i></h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/dashboard-escolar"><i class="bi bi-house"></i></a></li>
          <li class="breadcrumb-item active">Controle Transporte Administrativo</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->

    <section class="section dashboard">
      <div class="row">

        <!-- Left side columns -->
        <div class="col-lg-8">
          <div class="row">


            <!-- Solicitações Recentes -->
            <div class="col-12">
              <div class="card recent-sales overflow-auto">
                <div class="card-body">
                  <h5 class="card-title">Solicitações mais Recentes <button
                      onclick="window.location.href='/cadastrar-demandas';" class="btn btn-primary btn-sm ms-2"><i
                        class="bi bi-plus"></i> Nova Solicitação</button></h5>
                  <div class="d-flex justify-content-between mb-3">
                    <div>
                      <label for="itemsPerPage" class="form-label">Exibir:</label>
                      <select id="itemsPerPage" class="form-select form-select-sm"
                        style="width: auto; display: inline-block;">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                      </select>
                    </div>
                    <div>
                      <span id="totalSolicitacoes" class="mt-3"></span>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table table-borderless">
                      <thead>
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Origem</th>
                          <th scope="col">Destino</th>
                          <th scope="col">Data Partida</th>
                          <th scope="col">Data Término</th>
                          <th scope="col">Solicitante</th>
                          <th scope="col">Carga</th>
                          <th scope="col">Passageiros</th>
                          <th scope="col">Data Criação</th>
                          <th scope="col">Motorista</th>
                          <th scope="col">Status</th>
                          <th scope="col">Atraso</th>
                        </tr>
                      </thead>
                      <tbody id="solicitacoesRecentes">
                        <!-- Dados das solicitações -->
                      </tbody>
                    </table>
                  </div>
                  <div class="pagination-container mt-3">
                    <nav aria-label="Page navigation">
                      <ul class="pagination justify-content-center">
                        <!-- Paginação será adicionada dinamicamente aqui -->
                      </ul>
                    </nav>
                  </div>
                  <div id="loading" style="display:none;">Carregando...</div>
                </div>
              </div>
            </div>
            <!-- Fim de Solicitações Recentes -->


            <!-- Motoristas Mais Ativos -->
            <div class="col-12">
              <div class="card top-selling overflow-auto">

                <div class="card-body pb-0">
                  <h5 class="card-title">Motoristas Mais Ativos <span>| Este Mês</span></h5>

                  <table class="table table-borderless">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Nome do Motorista</th>
                        <th scope="col">Horas Trabalhadas</th>
                      </tr>
                    </thead>
                    <tbody id="motoristasMaisAtivos">
                      <!-- Dados dos motoristas mais ativos -->
                    </tbody>
                  </table>
                </div>

              </div>
            </div>
            <!-- Fim de Motoristas Mais Ativos -->

            <script>
              document.addEventListener('DOMContentLoaded', function () {
                const tableBody = document.getElementById('motoristasMaisAtivos');

                function fetchMotoristasMaisAtivos() {
                  fetch('/api/motoristas-mais-ativos')
                    .then(response => response.json())
                    .then(data => {
                      tableBody.innerHTML = '';

                      data.forEach((motorista, index) => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
              <th scope="row">${index + 1}</th>
              <td>${motorista.nome_completo}</td>
              <td>${secondsToHMS(motorista.total_horas_trabalhadas)}</td>
            `;
                        tableBody.appendChild(row);
                      });
                    })
                    .catch(error => console.error('Erro ao carregar motoristas mais ativos:', error));
                }

                fetchMotoristasMaisAtivos();
              });

              function secondsToHMS(seconds) {
                const h = Math.floor(seconds / 3600).toString().padStart(2, '0');
                const m = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');
                const s = Math.floor(seconds % 60).toString().padStart(2, '0');
                return `${h}:${m}:${s}`;
              }
            </script>


          </div>
        </div><!-- End Left side columns -->

        <!-- Right side columns -->
        <div class="col-lg-4">

          <!-- Recent Activity -->
          <!-- Atualizações Recentes de Rotas -->
          <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filtrar por Motorista</h6>
                </li>
                <li><a class="dropdown-item" href="#">Carlos Silva</a></li>
                <li><a class="dropdown-item" href="#">Ana Júlia</a></li>
                <li><a class="dropdown-item" href="#">Ricardo Gomes</a></li>
                <li><a class="dropdown-item" href="#">Márcia Andrade</a></li>
                <li><a class="dropdown-item" href="#">Luiz Henrique</a></li>
                <!-- Adicione mais motoristas conforme necessário -->
              </ul>
            </div>

            <div class="card-body">
              <h5 class="card-title">Atualizações de Rotas <span>| Hoje</span></h5>

              <div class="activity">
                <div class="activity-item d-flex">
                  <div class="activite-label">10 min</div>
                  <i class='bi bi-circle-fill activity-badge text-success align-self-start'></i>
                  <div class="activity-content">
                    Rota completa por <a href="#" class="fw-bold text-dark">Carlos Silva</a> na Zona Urbana.
                  </div>
                </div><!-- Fim do item de atividade -->

                <div class="activity-item d-flex">
                  <div class="activite-label">30 min</div>
                  <i class='bi bi-circle-fill activity-badge text-warning align-self-start'></i>
                  <div class="activity-content">
                    Atraso reportado por <a href="#" class="fw-bold text-dark">Ana Júlia</a> devido ao tráfego intenso.
                  </div>
                </div><!-- Fim do item de atividade -->

                <div class="activity-item d-flex">
                  <div class="activite-label">1 hora</div>
                  <i class='bi bi-circle-fill activity-badge text-danger align-self-start'></i>
                  <div class="activity-content">
                    Manutenção urgente solicitada por <a href="#" class="fw-bold text-dark">Ricardo Gomes</a> no
                    veículo.
                  </div>
                </div><!-- Fim do item de atividade -->

                <div class="activity-item d-flex">
                  <div class="activite-label">2 horas</div>
                  <i class='bi bi-circle-fill activity-badge text-info align-self-start'></i>
                  <div class="activity-content">
                    Rota extra iniciada por <a href="#" class="fw-bold text-dark">Márcia Andrade</a> para atender
                    demanda escolar.
                  </div>
                </div><!-- Fim do item de atividade -->

                <div class="activity-item d-flex">
                  <div class="activite-label">3 horas</div>
                  <i class='bi bi-circle-fill activity-badge text-success align-self-start'></i>
                  <div class="activity-content">
                    Rota concluída com sucesso por <a href="#" class="fw-bold text-dark">Luiz Henrique</a> na Zona
                    Rural.
                  </div>
                </div><!-- Fim do item de atividade -->

                <!-- Adicione mais itens de atividade conforme necessário -->
              </div>
            </div>
          </div>

          <!-- Budget Report -->
          <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filtrar</h6>
                </li>

                <li><a class="dropdown-item" href="#">Hoje</a></li>
                <li><a class="dropdown-item" href="#">Este Mês</a></li>
                <li><a class="dropdown-item" href="#">Este Ano</a></li>
              </ul>
            </div>

            <div class="card-body pb-0">
              <h5 class="card-title">Relatório de Orçamento <span>| Este Mês</span></h5>

              <div id="budgetChart" style="min-height: 400px;" class="echart"></div>

              <script>
                document.addEventListener("DOMContentLoaded", () => {
                  var budgetChart = echarts.init(document.querySelector("#budgetChart")).setOption({
                    legend: {
                      data: ['Orçamento Alocado', 'Gastos Reais']
                    },
                    radar: {
                      indicator: [
                        { name: 'Manutenção de Veículos', max: 50000 },
                        { name: 'Combustível', max: 40000 },
                        { name: 'Salários de Motoristas', max: 60000 },
                        { name: 'Equipamentos', max: 30000 },
                        { name: 'Administração', max: 25000 },
                        { name: 'Marketing', max: 20000 }
                      ]
                    },
                    series: [{
                      name: 'Orçamento vs Gastos',
                      type: 'radar',
                      data: [
                        { value: [45000, 32000, 48000, 25000, 20000, 15000], name: 'Orçamento Alocado' },
                        { value: [40000, 35000, 50000, 20000, 18000, 12000], name: 'Gastos Reais' }
                      ]
                    }]
                  });
                });
              </script>

            </div>
          </div><!-- End Budget Report -->

        </div><!-- End Right side columns -->

      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Rodapé ======= -->
  <footer id="footer" class="footer">
    <div class="container">
      <div class="row gy-4">


        <div class="container mt-4">
          <div class="row">
            <div class="col-md-6">
              <div class="copyright">
                &copy; Direitos Autorais <strong><span>PyDenExpress</span></strong>. Todos os Direitos Reservados
              </div>
            </div>
            <div class="col-md-6">
              <div class="credits">
                Desenvolvido por <a href="https://danilomorais.netlify.app/">Danilo de Morais</a>
              </div>
            </div>
          </div>
        </div>
  </footer><!-- Fim do Rodapé -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>
  <!-- Vendor JS Files -->
  <script src="/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/vendor/chart.js/chart.umd.js"></script>
  <script src="/vendor/echarts/echarts.min.js"></script>
  <script src="/vendor/quill/quill.min.js"></script>
  <script src="/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="/vendor/tinymce/tinymce.min.js"></script>

  <!-- Template Main JS File -->
  <script src="/js/main.js"></script>
  <script src="/js/users-profile.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const tableBody = document.getElementById('solicitacoesRecentes');
      const loading = document.getElementById('loading');
      const totalSolicitacoesSpan = document.getElementById('totalSolicitacoes');
      const itemsPerPageSelect = document.getElementById('itemsPerPage');
      const paginationContainer = document.querySelector('.pagination');
      let currentPage = 1;
      let itemsPerPage = parseInt(itemsPerPageSelect.value);

      function fetchSolicitacoesRecentes(page = 1) {
        tableBody.innerHTML = '';
        loading.style.display = 'block';

        fetch(`/api/solicitacoes-recentes?page=${page}&limit=${itemsPerPage}`)
          .then(response => response.json())
          .then(data => {
            const { solicitacoes, totalSolicitacoes } = data;

            solicitacoes.forEach((solicitacao) => {
              const statusClass = getStatusClass(solicitacao.status);
              const motoristaNome = solicitacao.motorista_nome || 'Não atribuído';
              const row = document.createElement('tr');
              row.innerHTML = `
                        <th scope="row"><a href="#">#${solicitacao.id}</a></th>
                        <td>${solicitacao.origem}</td>
                        <td>${solicitacao.destino}</td>
                        <td>${new Date(solicitacao.data_hora_partida).toLocaleString()}</td>
                        <td>${new Date(solicitacao.data_hora_termino_estimado).toLocaleString()}</td>
                        <td>${solicitacao.solicitante}</td>
                        <td>${solicitacao.tem_carga ? 'Sim' : 'Não'}</td>
                        <td>${solicitacao.quantidade_passageiros}</td>
                        <td>${new Date(solicitacao.data_criacao).toLocaleString()}</td>
                        <td>${motoristaNome}</td>
                        <td><span class="badge ${statusClass}">${solicitacao.status}</span></td>
                        <td>${solicitacao.atraso ? 'Sim' : 'Não'}</td>
                    `;
              tableBody.appendChild(row);
            });

            totalSolicitacoesSpan.textContent = `Total de solicitações: ${totalSolicitacoes}`;
            renderPagination(totalSolicitacoes);
          })
          .catch(error => console.error('Erro ao carregar solicitações:', error))
          .finally(() => loading.style.display = 'none');
      }

      function getStatusClass(status) {
        switch (status) {
          case 'Em andamento':
            return 'badge-primary';
          case 'Concluida':
            return 'badge-success';
          case 'Pendente':
            return 'badge-warning';
          case 'Rejeitada':
            return 'badge-danger';
          default:
            return '';
        }
      }

      function renderPagination(totalSolicitacoes) {
        paginationContainer.innerHTML = '';
        const pageCount = Math.ceil(totalSolicitacoes / itemsPerPage);

        for (let i = 1; i <= pageCount; i++) {
          const li = document.createElement('li');
          li.className = `page-item ${i === currentPage ? 'active' : ''}`;
          li.innerHTML = `<a class="page-link" href="#">${i}</a>`;
          li.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage = i;
            fetchSolicitacoesRecentes(currentPage);
          });
          paginationContainer.appendChild(li);
        }
      }

      itemsPerPageSelect.addEventListener('change', function () {
        itemsPerPage = parseInt(this.value);
        currentPage = 1;
        fetchSolicitacoesRecentes(currentPage);
      });

      fetchSolicitacoesRecentes(currentPage);
    });
  </script>
</body>

</html>